import{r as a,j as e,L as V,a as w}from"./app-DM5lWH7w.js";import{A as U,B as G}from"./Breadcrumb-DriWI8JK.js";import{B as f}from"./button-D_azY7HU.js";import{I as _}from"./input-C9qzQYtQ.js";import{T as J,a as O,b as j,c as b,d as W,e as r}from"./table-BGT-YAZs.js";import{S as X,a as Y,b as Z,c as ee,d as S}from"./select-lTbdTkTd.js";import te from"./BannerForm-CaIcILmU.js";import{S as se}from"./switch-DrArOmrB.js";import{C as L}from"./calendar-D95ocz5F.js";import{S as ae}from"./square-pen-BCmOeaAW.js";import{T as re}from"./trash-2-Dy2jXSrq.js";import{A as ie}from"./arrow-up-down-BlfunGSh.js";import{f as le}from"./format-D9VrrLpI.js";import"./shopping-cart-CZJG6TeG.js";import"./index-H22tECQ6.js";import"./utils-De8wPBUk.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./index-ijvaBZ7a.js";import"./index-v8iwHGUi.js";import"./index-BeqeRdpr.js";import"./index-o3Sz-yc3.js";import"./check-Ct5f1nwX.js";import"./dialog-_yQDYPAD.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./textarea-V4QGxS2H.js";import"./label-Dh85IkX1.js";function $e(){const[d,T]=a.useState([]),[F,k]=a.useState(!0),[o,H]=a.useState(""),[m,I]=a.useState("all"),[x,q]=a.useState(""),[h,A]=a.useState(""),[E,p]=a.useState(!1),[P,u]=a.useState(null),[l,B]=a.useState({current_page:1,per_page:10,total:0,last_page:1}),[y,$]=a.useState("order_sequence"),[v,C]=a.useState("asc"),g=async()=>{try{k(!0);const t={};o&&o.trim()!==""&&(t.search=o.trim()),m!=="all"&&(t.is_active=m==="active"?1:0),x&&(t.from_date=x),h&&(t.to_date=h),t.page=l.current_page,t.per_page=l.per_page,t.sort_field=y,t.sort_direction=v;const s=await w.get("/api/v1/banners",{params:t});s.data&&s.data.data&&(T(s.data.data.data),B({current_page:s.data.data.current_page,per_page:s.data.data.per_page,total:s.data.data.total,last_page:s.data.data.last_page})),console.log("Banners:",s.data.data.data)}catch(t){console.error("Lỗi khi tải banner:",t),T([])}finally{k(!1)}};a.useEffect(()=>{const t=setTimeout(()=>{g()},300);return()=>clearTimeout(t)},[o,m,x,h,l.current_page,y,v]);const z=t=>{y===t?C(v==="asc"?"desc":"asc"):($(t),C("asc"))},K=async t=>{var s,i;if(confirm("Bạn có chắc chắn muốn xóa banner này không?"))try{(await w.delete(`/admin/banners/${t}`)).data.status==="success"&&(g(),alert("Banner đã được xóa thành công"))}catch(c){console.error("Lỗi khi xóa banner:",c),alert(((i=(s=c.response)==null?void 0:s.data)==null?void 0:i.message)||`Lỗi khi xóa banner ${t}`)}},M=async(t,s)=>{var i,c;try{(await w.put(`/admin/banners/${t}/toggle-status`,{is_active:!s})).data.status==="success"&&g()}catch(N){console.error("Lỗi khi thay đổi trạng thái banner:",N),alert(((c=(i=N.response)==null?void 0:i.data)==null?void 0:c.message)||"Lỗi khi thay đổi trạng thái banner")}},Q=[{label:"Banners",href:"/admin/banners"}],R=()=>{const t=[];for(let s=1;s<=l.last_page;s++)t.push(e.jsx(f,{variant:l.current_page===s?"default":"outline",className:"w-10 h-10",onClick:()=>B(i=>({...i,current_page:s})),children:s},s));return t},n=({field:t,children:s})=>e.jsx(b,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>z(t),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:s}),e.jsx(ie,{className:"w-4 h-4"})]})}),D=t=>t?le(new Date(t),"dd/MM/yyyy"):"";return e.jsxs(U,{children:[e.jsx(V,{title:"Quản lý Banner"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsx(G,{items:Q}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quản lý Banner"}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:e.jsx(f,{onClick:()=>{u(null),p(!0)},children:"Thêm banner mới"})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden mb-6",children:e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsx(_,{type:"text",placeholder:"Tìm kiếm theo tiêu đề...",value:o,onChange:t=>H(t.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(X,{value:m,onValueChange:I,children:[e.jsx(Y,{children:e.jsx(Z,{placeholder:"Lọc theo trạng thái"})}),e.jsxs(ee,{children:[e.jsx(S,{value:"all",children:"Tất cả trạng thái"}),e.jsx(S,{value:"active",children:"Đang hoạt động"}),e.jsx(S,{value:"inactive",children:"Không hoạt động"})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(_,{type:"date",value:x,onChange:t=>q(t.target.value),className:"w-full",placeholder:"Từ ngày"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx(_,{type:"date",value:h,onChange:t=>A(t.target.value),className:"w-full",placeholder:"Đến ngày"})]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(J,{children:[e.jsx(O,{children:e.jsxs(j,{className:"bg-gray-50",children:[e.jsx(n,{field:"id",children:"ID"}),e.jsx(b,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hình ảnh"}),e.jsx(n,{field:"title",children:"Tiêu đề"}),e.jsx(n,{field:"order_sequence",children:"Thứ tự"}),e.jsx(n,{field:"start_date",children:"Ngày bắt đầu"}),e.jsx(n,{field:"end_date",children:"Ngày kết thúc"}),e.jsx(n,{field:"is_active",children:"Trạng thái"}),e.jsx(b,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hành động"})]})}),e.jsx(W,{children:F?e.jsx(j,{children:e.jsx(r,{colSpan:8,className:"text-center py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})})})}):!d||d.length===0?e.jsx(j,{children:e.jsx(r,{colSpan:8,className:"text-center py-4 text-gray-500",children:"Không có banner nào"})}):d.map(t=>e.jsxs(j,{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs(r,{className:"py-4 px-6 text-sm text-gray-900 font-medium",children:["#",t.id]}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:t.image_url&&e.jsx("img",{src:t.image_url,alt:t.title,className:"h-16 w-auto object-cover rounded"})}),e.jsxs(r,{className:"py-4 px-6 text-sm text-gray-900",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsx("div",{className:"text-gray-500 text-xs mt-1",children:t.subtitle})]}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:t.order_sequence}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:D(t.start_date)}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:D(t.end_date)}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsx(se,{checked:t.is_active,onCheckedChange:()=>M(t.id,t.is_active)})}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",className:"text-amber-600 hover:text-amber-700",onClick:()=>{u(t),p(!0)},children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(f,{variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>K(t.id),children:e.jsx(re,{className:"h-4 w-4"})})]})})]},t.id))})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",d.length," trên ",l.total," banner"]}),e.jsx("div",{className:"flex gap-2",children:R()})]})]}),E&&e.jsx(te,{banner:P,onClose:()=>{p(!1),u(null)},onSuccess:()=>{p(!1),u(null),g()}})]})]})}export{$e as default};
