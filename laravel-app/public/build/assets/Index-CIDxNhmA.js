import{r as s,j as e,L as F,a as L}from"./app-DM5lWH7w.js";import{A as R,B as U}from"./Breadcrumb-DriWI8JK.js";import{B as u}from"./button-D_azY7HU.js";import{I as A}from"./input-C9qzQYtQ.js";import{T as Q,a as M,b as d,c as g,d as P,e as a}from"./table-BGT-YAZs.js";import q from"./StaffForm-BAbDvzns.js";import{A as K}from"./arrow-up-down-BlfunGSh.js";import{f as $}from"./format-D9VrrLpI.js";import"./shopping-cart-CZJG6TeG.js";import"./index-H22tECQ6.js";import"./utils-De8wPBUk.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./dialog-_yQDYPAD.js";import"./index-v8iwHGUi.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";function pe(){const[i,N]=s.useState([]),[_,f]=s.useState(!0),[x,w]=s.useState(""),[S,o]=s.useState(!1),[T,c]=s.useState(null),[l,j]=s.useState({current_page:1,per_page:10,total:0,last_page:1}),[m,C]=s.useState("name"),[p,y]=s.useState("asc"),[v,k]=s.useState([]),[h,H]=s.useState(""),b=async()=>{try{f(!0);const t=await L.get("/admin/users",{params:{search:x,role_id:h||void 0,page:l.current_page,per_page:l.per_page,sort_field:m,sort_direction:p}});t.data&&t.data.data&&(N(t.data.data),j({current_page:t.data.current_page,per_page:t.data.per_page,total:t.data.total,last_page:t.data.last_page}),t.data.roles&&k(t.data.roles))}catch(t){console.error("Lỗi khi tải danh sách nhân viên:",t)}finally{f(!1)}};s.useEffect(()=>{const t=setTimeout(()=>{b()},300);return()=>clearTimeout(t)},[x,l.current_page,m,p,h]);const I=t=>{m===t?y(p==="asc"?"desc":"asc"):(C(t),y("asc"))},B=[{label:"Quản lý nhân viên",href:"/admin/users"}],D=()=>{const t=[];for(let r=1;r<=l.last_page;r++)t.push(e.jsx(u,{variant:l.current_page===r?"default":"outline",className:"w-10 h-10",onClick:()=>j(E=>({...E,current_page:r})),children:r},r));return t},n=({field:t,children:r})=>e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I(t),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:r}),e.jsx(K,{className:"w-4 h-4"})]})});return e.jsxs(R,{children:[e.jsx(F,{title:"Quản lý nhân viên"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsx(U,{items:B}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quản lý nhân viên"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{type:"text",placeholder:"Tìm kiếm nhân viên...",value:x,onChange:t=>w(t.target.value),className:"w-full sm:w-64"}),e.jsxs("select",{value:h,onChange:t=>H(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Tất cả vai trò"}),v.map(t=>e.jsx("option",{value:t.role_id,children:t.name},t.role_id))]})]}),e.jsx(u,{onClick:()=>{c(null),o(!0)},children:"Thêm nhân viên mới"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Q,{children:[e.jsx(M,{children:e.jsxs(d,{className:"bg-gray-50",children:[e.jsx(n,{field:"id",children:"ID"}),e.jsx(n,{field:"name",children:"Tên"}),e.jsx(n,{field:"email",children:"Email"}),e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chức vụ"}),e.jsx(n,{field:"is_active",children:"Trạng thái"}),e.jsx(n,{field:"last_login",children:"Đăng nhập lần cuối"}),e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hành động"})]})}),e.jsx(P,{children:_?e.jsx(d,{children:e.jsx(a,{colSpan:7,className:"text-center py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})})})}):!i||i.length===0?e.jsx(d,{children:e.jsx(a,{colSpan:7,className:"text-center py-4 text-gray-500",children:"Không có nhân viên nào"})}):i.map(t=>e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.id}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),t.profile&&t.profile.full_name&&e.jsx("p",{className:"text-gray-500 text-xs",children:t.profile.full_name})]})}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.email}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.role?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:t.role.name}):"Chưa phân quyền"}),e.jsx(a,{className:"py-4 px-6 text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.is_active?"Hoạt động":"Tạm khóa"})}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.last_login?$(new Date(t.last_login),"dd/MM/yyyy HH:mm"):"Chưa đăng nhập"}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsx("div",{className:"flex gap-2",children:e.jsx(u,{variant:"outline",className:"text-blue-600 hover:text-blue-700 border border-blue-600 hover:border-blue-700",onClick:()=>{c(t),o(!0)},children:"Chỉnh sửa"})})})]},t.id))})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",i.length," trên ",l.total," nhân viên"]}),e.jsx("div",{className:"flex gap-2",children:D()})]})]}),S&&e.jsx(q,{staff:T,roles:v,onClose:()=>{o(!1),c(null)},onSuccess:()=>{o(!1),c(null),b()}})]})]})}export{pe as default};
