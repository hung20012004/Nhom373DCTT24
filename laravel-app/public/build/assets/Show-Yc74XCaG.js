import{r as o,j as s,L as m,a as K}from"./app-DM5lWH7w.js";import{A as u,B as A}from"./Breadcrumb-DriWI8JK.js";import{B as c}from"./button-D_azY7HU.js";import{C as t,a as r,b as n,c as i}from"./card-DjyVTpSh.js";import{B as M}from"./badge-D2PfSuDc.js";import{A as $}from"./arrow-left-D2uTfI0H.js";import{c as H}from"./index-H22tECQ6.js";import{C as R}from"./circle-check-big-CYwe5r7P.js";import{C as B}from"./circle-x-2_s-kJ5P.js";import{f as V}from"./format-D9VrrLpI.js";import{v as z}from"./vi-DmPgEhae.js";import"./shopping-cart-CZJG6TeG.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./utils-De8wPBUk.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=H("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function cs({requestId:l}){var b,v,w,_,C,k,T;const[e,S]=o.useState(null),[E,p]=o.useState(!0),j={new:"Mới",in_progress:"Đang xử lý",resolved:"Đã giải quyết",closed:"Đã đóng"},g={new:"bg-blue-100 text-blue-800",in_progress:"bg-yellow-100 text-yellow-800",resolved:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"},y={shipping:"Vấn đề vận chuyển",product:"Vấn đề sản phẩm",payment:"Vấn đề thanh toán",other:"Khác"},f={shipping:"bg-indigo-100 text-indigo-800",product:"bg-purple-100 text-purple-800",payment:"bg-cyan-100 text-cyan-800",other:"bg-rose-100 text-rose-800"},N=async()=>{try{p(!0);const a=await K.get(`/api/v1/support-requests/${l}`);a.data&&a.data.data&&S(a.data.data)}catch(a){console.error("Lỗi khi tải yêu cầu hỗ trợ:",a)}finally{p(!1)}};o.useEffect(()=>{N()},[l]);const d=a=>a?V(new Date(a),"dd/MM/yyyy HH:mm",{locale:z}):"",h=async a=>{var L,q;try{(await K.put(`/admin/support-requests/${l}/status`,{status:a})).data.status==="success"&&(N(),alert("Trạng thái yêu cầu hỗ trợ đã được cập nhật thành công"))}catch(x){console.error("Lỗi khi cập nhật trạng thái yêu cầu hỗ trợ:",x),alert(((q=(L=x.response)==null?void 0:L.data)==null?void 0:q.message)||"Lỗi khi cập nhật trạng thái yêu cầu hỗ trợ")}},Y=[{label:"Yêu cầu hỗ trợ",href:"/admin/support-requests"},{label:`Chi tiết yêu cầu #${l}`,href:`/admin/support-requests/${l}`}];return E?s.jsxs(u,{children:[s.jsx(m,{title:"Đang tải..."}),s.jsx("div",{className:"container mx-auto py-6 px-4",children:s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})})})]}):e?s.jsxs(u,{children:[s.jsx(m,{title:`Yêu cầu hỗ trợ #${e.id}`}),s.jsxs("div",{className:"container mx-auto py-6 px-4",children:[s.jsx(A,{items:Y}),s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Yêu cầu hỗ trợ #",e.id]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(c,{variant:"outline",onClick:()=>window.location.href="/admin/support-requests",children:[s.jsx($,{className:"mr-2 h-4 w-4"}),"Quay lại"]}),e.status==="new"&&s.jsxs(c,{className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>h("in_progress"),children:[s.jsx(D,{className:"mr-2 h-4 w-4"}),"Bắt đầu xử lý"]}),e.status==="in_progress"&&s.jsxs(c,{className:"bg-green-600 hover:bg-green-700",onClick:()=>h("resolved"),children:[s.jsx(R,{className:"mr-2 h-4 w-4"}),"Đánh dấu đã giải quyết"]}),(e.status==="new"||e.status==="in_progress")&&s.jsxs(c,{variant:"destructive",onClick:()=>h("closed"),children:[s.jsx(B,{className:"mr-2 h-4 w-4"}),"Đóng yêu cầu"]})]})]}),e.status==="in_progress"?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[s.jsxs(t,{children:[s.jsx(r,{children:s.jsx(n,{children:"Thông tin yêu cầu"})}),s.jsx(i,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Mã yêu cầu:"}),s.jsxs("span",{className:"font-medium",children:["#",e.id]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Ngày tạo:"}),s.jsx("span",{children:d(e.created_at)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Trạng thái:"}),s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${g[e.status]}`,children:j[e.status]||e.status})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Loại vấn đề:"}),s.jsx(M,{className:f[e.issue_type]||"bg-gray-100",children:y[e.issue_type]||e.issue_type})]}),e.order_id&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Đơn hàng:"}),s.jsxs("a",{href:`/admin/orders/${e.order_id}`,className:"text-blue-600 hover:underline",children:["#",e.order_id]})]})]})})]}),s.jsxs(t,{children:[s.jsx(r,{children:s.jsx(n,{children:"Thông tin người phụ trách"})}),s.jsx(i,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Người phụ trách:"}),s.jsx("span",{className:"font-medium",children:(b=e.resolver)==null?void 0:b.name})]}),e.resolved_at&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Ngày giải quyết:"}),s.jsx("span",{children:d(e.resolved_at)})]})]})})]}),s.jsxs(t,{children:[s.jsx(r,{children:s.jsx(n,{children:"Thông tin khách hàng"})}),s.jsx(i,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Tên khách hàng:"}),s.jsx("span",{className:"font-medium",children:((v=e.user)==null?void 0:v.name)||"Không có"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Email:"}),s.jsx("span",{children:((w=e.user)==null?void 0:w.email)||"Không có"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Điện thoại:"}),s.jsx("span",{children:((_=e.user)==null?void 0:_.phone)||"Không có"})]})]})})]})]}):s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs(t,{children:[s.jsx(r,{children:s.jsx(n,{children:"Thông tin yêu cầu"})}),s.jsx(i,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Mã yêu cầu:"}),s.jsxs("span",{className:"font-medium",children:["#",e.id]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Ngày tạo:"}),s.jsx("span",{children:d(e.created_at)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Trạng thái:"}),s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${g[e.status]}`,children:j[e.status]||e.status})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Loại vấn đề:"}),s.jsx(M,{className:f[e.issue_type]||"bg-gray-100",children:y[e.issue_type]||e.issue_type})]}),e.order_id&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Đơn hàng:"}),s.jsxs("a",{href:`/admin/orders/${e.order_id}`,className:"text-blue-600 hover:underline",children:["#",e.order_id]})]})]})})]}),s.jsxs(t,{children:[s.jsx(r,{children:s.jsx(n,{children:"Thông tin khách hàng"})}),s.jsx(i,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Tên khách hàng:"}),s.jsx("span",{className:"font-medium",children:((C=e.user)==null?void 0:C.name)||"Không có"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Email:"}),s.jsx("span",{children:((k=e.user)==null?void 0:k.email)||"Không có"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Điện thoại:"}),s.jsx("span",{children:((T=e.user)==null?void 0:T.phone)||"Không có"})]})]})})]})]}),s.jsxs(t,{className:"mb-6",children:[s.jsx(r,{children:s.jsx(n,{children:"Mô tả vấn đề"})}),s.jsx(i,{children:s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 whitespace-pre-wrap",children:e.description})})]}),e.status==="closed"&&s.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx(B,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),s.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Yêu cầu hỗ trợ đã đóng"})]})]})]}):s.jsxs(u,{children:[s.jsx(m,{title:"Không tìm thấy yêu cầu hỗ trợ"}),s.jsx("div",{className:"container mx-auto py-6 px-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Không tìm thấy yêu cầu hỗ trợ"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Yêu cầu hỗ trợ bạn đang tìm kiếm không tồn tại hoặc đã bị xóa."}),s.jsxs(c,{className:"mt-4",onClick:()=>window.location.href="/admin/support-requests",children:[s.jsx($,{className:"mr-2 h-4 w-4"}),"Quay lại danh sách"]})]})})]})}export{cs as default};
