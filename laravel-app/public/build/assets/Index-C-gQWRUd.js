import{r as a,j as e,L as A,a as w}from"./app-DM5lWH7w.js";import{A as D,B as E}from"./Breadcrumb-DriWI8JK.js";import{B as m}from"./button-D_azY7HU.js";import{I}from"./input-C9qzQYtQ.js";import{T as K,a as $,b as d,c as x,d as P,e as r}from"./table-BGT-YAZs.js";import R from"./CategoryForm-CP1kn-i8.js";import{A as M}from"./arrow-up-down-BlfunGSh.js";import"./shopping-cart-CZJG6TeG.js";import"./index-H22tECQ6.js";import"./utils-De8wPBUk.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./dialog-_yQDYPAD.js";import"./index-v8iwHGUi.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./label-Dh85IkX1.js";import"./textarea-V4QGxS2H.js";import"./alert-cZJMHzEk.js";import"./switch-DrArOmrB.js";function pe(){const[l,b]=a.useState([]),[_,N]=a.useState(!0),[p,S]=a.useState(""),[k,o]=a.useState(!1),[C,c]=a.useState(null),[n,y]=a.useState({current_page:1,per_page:10,total:0,last_page:1}),[h,T]=a.useState("name"),[u,v]=a.useState("asc"),g=async()=>{try{N(!0);const s=await w.get("/api/v1/categories",{params:{search:p,page:n.current_page,per_page:n.per_page,sort_field:h,sort_direction:u}});s.data&&s.data.data&&(b(s.data.data),y({current_page:s.data.current_page,per_page:s.data.per_page,total:s.data.total,last_page:s.data.last_page}))}catch(s){console.error("Lỗi khi tải loại sản phẩm:",s),b([])}finally{N(!1)}};a.useEffect(()=>{const s=setTimeout(()=>{g()},300);return()=>clearTimeout(s)},[p,n.current_page,h,u]);const L=s=>{h===s?v(u==="asc"?"desc":"asc"):(T(s),v("asc"))},H=async s=>{var t,i;if(confirm("Bạn có chắc chắn muốn xóa loại sản phẩm này không?"))try{(await w.delete(`/admin/categories/${s}`)).status===200&&(g(),alert("Loại sản phẩm đã được xóa thành công"))}catch(j){console.error("Lỗi khi xóa loại sản phẩm:",j),alert(((i=(t=j.response)==null?void 0:t.data)==null?void 0:i.message)||`Lỗi khi xóa loại sản phẩm ${s}`)}},B=[{label:"Loại sản phẩm",href:"/admin/categories"}],F=()=>{const s=[];for(let t=1;t<=n.last_page;t++)s.push(e.jsx(m,{variant:n.current_page===t?"default":"outline",className:"w-10 h-10",onClick:()=>y(i=>({...i,current_page:t})),children:t},t));return s},f=({field:s,children:t})=>e.jsx(x,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>L(s),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t}),e.jsx(M,{className:"w-4 h-4"})]})});return e.jsxs(D,{children:[e.jsx(A,{title:"Quản lý loại sản phẩm"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsx(E,{items:B}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Loại sản phẩm"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsx(I,{type:"text",placeholder:"Tìm kiếm loại sản phẩm...",value:p,onChange:s=>S(s.target.value),className:"w-full sm:w-64"}),e.jsx(m,{onClick:()=>{c(null),o(!0)},children:"Thêm loại sản phẩm mới"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(K,{children:[e.jsx($,{children:e.jsxs(d,{className:"bg-gray-50",children:[e.jsx(x,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hình ảnh"}),e.jsx(f,{field:"name",children:"Tên"}),e.jsx(f,{field:"slug",children:"Slug"}),e.jsx(f,{field:"is_active",children:"Trạng thái"}),e.jsx(x,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mô tả"}),e.jsx(x,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hành động"})]})}),e.jsx(P,{children:_?e.jsx(d,{children:e.jsx(r,{colSpan:6,className:"text-center py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})})})}):!l||l.length===0?e.jsx(d,{children:e.jsx(r,{colSpan:6,className:"text-center py-4 text-gray-500",children:"Không có loại sản phẩm nào"})}):l.map(s=>{var t,i;return e.jsxs(d,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-16 h-16 object-cover rounded-lg"}):e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"Không có hình ảnh"})})}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:s.name}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:s.slug}),e.jsx(r,{className:"py-4 px-6 text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"Hoạt động":"Không hoạt động"})}),e.jsxs(r,{className:"py-4 px-6 text-sm text-gray-900",children:[(t=s.description)==null?void 0:t.substring(0,50),((i=s.description)==null?void 0:i.length)>50?"...":""]}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"outline",className:"text-blue-600 hover:text-blue-700 border border-blue-600 hover:border-blue-700",onClick:()=>{c(s),o(!0)},children:"Chỉnh sửa"}),e.jsx(m,{variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>H(s.id),children:"Xóa"})]})})]},s.id)})})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",l.length," trên ",n.total," loại sản phẩm"]}),e.jsx("div",{className:"flex gap-2",children:F()})]})]}),k&&e.jsx(R,{category:C,onClose:()=>{o(!1),c(null)},onSuccess:()=>{o(!1),c(null),g()}})]})]})}export{pe as default};
