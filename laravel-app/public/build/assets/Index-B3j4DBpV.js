import{r as s,j as e,L as I,a as N}from"./app-DM5lWH7w.js";import L from"./VariantDisplay-BuNXq9vA.js";import{A as q,B as A}from"./Breadcrumb-DriWI8JK.js";import{B as m}from"./button-D_azY7HU.js";import{I as K}from"./input-C9qzQYtQ.js";import{T as M,a as E,b as p,c as g,d as V,e as r}from"./table-BGT-YAZs.js";import F from"./ProductForm-CyqY8xv0.js";import{A as R}from"./arrow-up-down-BlfunGSh.js";import"./shopping-cart-CZJG6TeG.js";import"./index-H22tECQ6.js";import"./utils-De8wPBUk.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./dialog-_yQDYPAD.js";import"./index-v8iwHGUi.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./BasicInformationForm-XhX9AK3u.js";import"./label-Dh85IkX1.js";import"./select-lTbdTkTd.js";import"./index-BeqeRdpr.js";import"./index-o3Sz-yc3.js";import"./check-Ct5f1nwX.js";import"./checkbox-D22MXWb1.js";import"./PricingInventoryForm-B4Hqvwzi.js";import"./DescriptionForm-JJHQXmhP.js";import"./textarea-V4QGxS2H.js";import"./TagsManager-CU62H3ef.js";import"./badge-D2PfSuDc.js";import"./plus-DECCMGFS.js";import"./VariantsManager-CYWwn-Ff.js";import"./card-DjyVTpSh.js";import"./trash-B9vdY9Sb.js";import"./ImagesManager-BVlVwD0g.js";import"./Utils-EKZXVTee.js";function Ce(){const[o,y]=s.useState([]),[v,j]=s.useState(!0),[x,w]=s.useState(""),[S,c]=s.useState(!1),[f,l]=s.useState(null),[n,_]=s.useState({trang_hien_tai:1,so_luong_moi_trang:10,tong_so:0,trang_cuoi:1}),[d,T]=s.useState("name"),[u,b]=s.useState("asc");console.log("suaSanPham trong Index:",f);const h=async()=>{try{j(!0);const t=await N.get("/api/v1/products",{params:{search:x,page:n.trang_hien_tai,per_page:n.so_luong_moi_trang,sort_field:d,sort_direction:u,with:"variants.color,variants.size,category, material, tag"}});t.data&&t.data.data&&(y(t.data.data),_({trang_hien_tai:t.data.current_page,so_luong_moi_trang:t.data.per_page,tong_so:t.data.total,trang_cuoi:t.data.last_page}))}catch(t){console.error("Lỗi khi lấy danh sách sản phẩm:",t),y([])}finally{j(!1)}};s.useEffect(()=>{const t=setTimeout(()=>{h()},300);return()=>clearTimeout(t)},[x,n.trang_hien_tai,d,u]);const k=t=>{d===t?b(u==="asc"?"desc":"asc"):(T(t),b("asc"))},B=async t=>{if(confirm("Bạn có chắc chắn muốn xóa sản phẩm này không?"))try{await N.delete(`/admin/products/${t}`),h()}catch(a){console.error("Lỗi khi xóa sản phẩm:",a)}},C=[{label:"Sản phẩm",href:"/admin/products"}],D=()=>{const t=[];for(let a=1;a<=n.trang_cuoi;a++)t.push(e.jsx(m,{variant:n.trang_hien_tai===a?"default":"outline",className:"w-10 h-10",onClick:()=>_(H=>({...H,trang_hien_tai:a})),children:a},a));return t},i=({truong:t,children:a})=>e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>k(t),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a}),e.jsx(R,{className:"w-4 h-4"})]})}),X=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t);return e.jsxs(q,{children:[e.jsx(I,{title:"Quản lý Sản phẩm"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsx(A,{items:C}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sản phẩm"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsx(K,{type:"text",placeholder:"Tìm kiếm sản phẩm...",value:x,onChange:t=>w(t.target.value),className:"w-full sm:w-64"}),e.jsx(m,{onClick:()=>{l(null),c(!0)},children:"Thêm sản phẩm mới"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(M,{children:[e.jsx(E,{children:e.jsxs(p,{className:"bg-gray-50",children:[e.jsx(i,{truong:"id",children:"ID"}),e.jsx(i,{truong:"brand",children:"Thương Hiệu"}),e.jsx(i,{truong:"name",children:"Tên"}),e.jsx(i,{truong:"category",children:"Danh Mục"}),e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Biến Thể"}),e.jsx(i,{truong:"price",children:"Giá"}),e.jsx(i,{truong:"stock_quantity",children:"Tồn Kho"}),e.jsx(g,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hành Động"})]})}),e.jsx(V,{children:v?e.jsx(p,{children:e.jsx(r,{colSpan:6,className:"text-center py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})})})}):!o||o.length===0?e.jsx(p,{children:e.jsx(r,{colSpan:6,className:"text-center py-4 text-gray-500",children:"Không tìm thấy sản phẩm"})}):o.map(t=>{var a;return e.jsxs(p,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:t.product_id}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:t.brand}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:t.name}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:((a=t.category)==null?void 0:a.name)||"Chưa phân loại"}),e.jsx(r,{className:"py-4 px-6",children:e.jsx(L,{variants:t.variants})}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:X(t.price)}),e.jsx(r,{className:"py-4 px-6 text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.stock_quantity>10?"bg-green-100 text-green-800":t.stock_quantity>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.stock_quantity})}),e.jsx(r,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"outline",className:"text-blue-600 hover:text-blue-700 border border-blue-600 hover:border-blue-700",onClick:()=>{l(t),c(!0)},children:"Sửa"}),e.jsx(m,{variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>B(t.product_id),children:"Xóa"})]})})]},t.product_id)})})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",o.length," trong tổng số ",n.tong_so," kết quả"]}),e.jsx("div",{className:"flex gap-2",children:D()})]})]}),S&&e.jsx(F,{product:f,onClose:()=>{c(!1),l(null)},onSuccess:()=>{c(!1),l(null),h()}})]})]})}export{Ce as default};
