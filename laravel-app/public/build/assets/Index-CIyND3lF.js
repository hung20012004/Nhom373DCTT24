import{r,j as e,L as H,a as w}from"./app-DM5lWH7w.js";import{A as I,B as L}from"./Breadcrumb-DriWI8JK.js";import{B as d}from"./button-D_azY7HU.js";import{I as D}from"./input-C9qzQYtQ.js";import{T as $,a as P,b as m,c as p,d as R,e as a}from"./table-BGT-YAZs.js";import X from"./SupplierForm-Cvsqws_p.js";import{A as q}from"./arrow-up-down-BlfunGSh.js";import"./shopping-cart-CZJG6TeG.js";import"./index-H22tECQ6.js";import"./utils-De8wPBUk.js";import"./star-NL1IKTr_.js";import"./truck-PZjfZowP.js";import"./shopping-bag-D-8jhm6x.js";import"./users-Bg5QJiIM.js";import"./search-DZ4Pfh-R.js";import"./user-DrHZ__g_.js";import"./dialog-_yQDYPAD.js";import"./index-v8iwHGUi.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./label-Dh85IkX1.js";import"./textarea-V4QGxS2H.js";import"./alert-cZJMHzEk.js";import"./switch-DrArOmrB.js";function pe(){const[c,y]=r.useState([]),[_,N]=r.useState(!0),[h,S]=r.useState(""),[T,o]=r.useState(!1),[k,x]=r.useState(null),[l,b]=r.useState({current_page:1,per_page:10,total:0,last_page:1}),[g,C]=r.useState("name"),[u,v]=r.useState("asc"),f=async()=>{try{N(!0);const t=await w.get("/api/v1/suppliers",{params:{search:h,page:l.current_page,per_page:l.per_page,sort_field:g,sort_direction:u}});t.data&&(y(t.data.data),b({current_page:t.data.current_page,per_page:t.data.per_page,total:t.data.total,last_page:t.data.last_page}))}catch(t){console.error("Error fetching suppliers:",t),y([])}finally{N(!1)}};r.useEffect(()=>{const t=setTimeout(()=>{f()},300);return()=>clearTimeout(t)},[h,l.current_page,g,u]);const E=t=>{g===t?v(u==="asc"?"desc":"asc"):(C(t),v("asc"))},B=async t=>{var s,n;if(confirm("Bạn có muốn xóa?"))try{(await w.delete(`/admin/suppliers/${t}`)).status===200&&(f(),alert("Xóa thành công"))}catch(j){console.error("Error deleting supplier:",j),alert(((n=(s=j.response)==null?void 0:s.data)==null?void 0:n.message)||`Error deleting supplier ${t}`)}},A=[{label:"Nhà cung cấp",href:"/admin/suppliers"}],F=()=>{const t=[];for(let s=1;s<=l.last_page;s++)t.push(e.jsx(d,{variant:l.current_page===s?"default":"outline",className:"w-10 h-10",onClick:()=>b(n=>({...n,current_page:s})),children:s},s));return t},i=({field:t,children:s})=>e.jsx(p,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E(t),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:s}),e.jsx(q,{className:"w-4 h-4"})]})});return e.jsxs(I,{children:[e.jsx(H,{title:"Quản lý nhà cung cấp"}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsx(L,{items:A}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Nhà cung cấp"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsx(D,{type:"text",placeholder:"Tìm kiếm nhà cung cấp...",value:h,onChange:t=>S(t.target.value),className:"w-full sm:w-64"}),e.jsx(d,{onClick:()=>{x(null),o(!0)},children:"Thêm nhà cung cấp mới"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs($,{children:[e.jsx(P,{children:e.jsxs(m,{className:"bg-gray-50",children:[e.jsx(p,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Logo"}),e.jsx(i,{field:"name",children:"Tên"}),e.jsx(i,{field:"contact_name",children:"Tên công ty"}),e.jsx(i,{field:"email",children:"Email"}),e.jsx(i,{field:"phone",children:"Số điện thoại"}),e.jsx(p,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Địa chỉ"}),e.jsx(i,{field:"is_active",children:"Trạng thái"}),e.jsx(p,{className:"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hành động"})]})}),e.jsx(R,{children:_?e.jsx(m,{children:e.jsx(a,{colSpan:8,className:"text-center py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})})})}):!c||c.length===0?e.jsx(m,{children:e.jsx(a,{colSpan:8,className:"text-center py-4 text-gray-500",children:"No suppliers found"})}):c.map(t=>{var s,n;return e.jsxs(m,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.logo_url?e.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"w-10 h-10 object-cover rounded"}):e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-xs",children:"No logo"})})}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.name}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.contact_name}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.email}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:t.phone}),e.jsxs(a,{className:"py-4 px-6 text-sm text-gray-900",children:[(s=t.address)==null?void 0:s.substring(0,50),((n=t.address)==null?void 0:n.length)>50?"...":""]}),e.jsx(a,{className:"py-4 px-6 text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.is_active?"Active":"Inactive"})}),e.jsx(a,{className:"py-4 px-6 text-sm text-gray-900",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",className:"text-blue-600 hover:text-blue-700 border border-blue-600 hover:border-blue-700",onClick:()=>{x(t),o(!0)},children:"Cập nhật"}),e.jsx(d,{variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>B(t.id),children:"Xóa"})]})})]},t.id)})})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",c.length," trên ",l.total," kết quả"]}),e.jsx("div",{className:"flex gap-2",children:F()})]})]}),T&&e.jsx(X,{supplier:k,onClose:()=>{o(!1),x(null)},onSuccess:()=>{o(!1),x(null),f()}})]})]})}export{pe as default};
