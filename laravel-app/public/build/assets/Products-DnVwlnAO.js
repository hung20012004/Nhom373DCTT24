import{b as E,r as d,j as e,L as W}from"./app-DM5lWH7w.js";import{H as R,L as T}from"./Layout-DVh4xpEi.js";import{P as H}from"./ProductGrid-BVqQ31xF.js";import{c as D}from"./index-H22tECQ6.js";import{S as U}from"./search-DZ4Pfh-R.js";import{A as B}from"./arrow-up-OkNl_Rwn.js";import"./index-o3Sz-yc3.js";import"./index-v8iwHGUi.js";import"./dialog-_yQDYPAD.js";import"./utils-De8wPBUk.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./button-D_azY7HU.js";import"./trash-2-Dy2jXSrq.js";import"./plus-DECCMGFS.js";import"./alert-cZJMHzEk.js";import"./checkbox-D22MXWb1.js";import"./check-Ct5f1nwX.js";import"./shopping-cart-CZJG6TeG.js";import"./user-DrHZ__g_.js";import"./mail-CpnXhq4x.js";import"./star-NL1IKTr_.js";import"./circle-alert-DyacK_RC.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=D("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),z=({categories:n,filters:c,onFilterChange:p,wishlistCount:S})=>{const{wishlist:u}=E(),w=(u==null?void 0:u.length)||0||S||0,[x,a]=d.useState(c.search||""),[m,_]=d.useState(!0),k=l=>{a(l.target.value)},j=l=>{l.preventDefault(),p("search",x)},g=()=>{a(""),p("search","")};return e.jsx("div",{className:"lg:w-1/4",children:e.jsxs("div",{className:"bg-white border border-neutral-100 rounded-xl p-6 space-y-8 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between lg:hidden",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"Bộ lọc"]}),e.jsx("button",{onClick:()=>_(!m),className:"text-gray-500 hover:text-gray-700",children:m?"Ẩn":"Hiện"})]}),e.jsxs("div",{className:`space-y-8 ${m?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Tìm kiếm sản phẩm"}),e.jsxs("form",{onSubmit:j,className:"relative",children:[e.jsx("input",{type:"text",value:x,onChange:k,placeholder:"Nhập tên sản phẩm...",className:"w-full border-neutral-200 rounded-lg pl-4 pr-10 py-3 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 h-full px-3 text-gray-500 hover:text-blue-600 transition-colors","aria-label":"Tìm kiếm",children:e.jsx(U,{className:"w-5 h-5"})}),x&&e.jsx("button",{type:"button",onClick:g,className:"absolute right-10 top-0 h-full px-2 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Xóa tìm kiếm",children:"×"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Sắp xếp theo"}),e.jsxs("select",{value:c.sort,onChange:l=>p("sort",l.target.value),className:"w-full border-neutral-200 rounded-lg py-3 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all",children:[e.jsx("option",{value:"newest",children:"Sản phẩm mới nhất"}),e.jsx("option",{value:"price_asc",children:"Giá: Thấp đến cao"}),e.jsx("option",{value:"price_desc",children:"Giá: Cao đến thấp"}),e.jsx("option",{value:"name_asc",children:"Tên: A đến Z"}),e.jsx("option",{value:"name_desc",children:"Tên: Z đến A"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Danh mục sản phẩm"}),e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("button",{onClick:()=>p("category",""),className:`block w-full text-left px-4 py-3 rounded-lg transition-colors ${!c.category&&c.filter_type!=="wishlist"?"bg-blue-50 text-blue-700 font-medium border-l-4 border-blue-500":"hover:bg-gray-50"}`,children:"Toàn bộ sản phẩm"}),e.jsxs("button",{onClick:()=>p("filter_type","wishlist"),className:`block w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center ${c.filter_type==="wishlist"?"bg-blue-50 text-blue-700 font-medium border-l-4 border-blue-500":"hover:bg-gray-50"}`,children:[e.jsx(R,{className:`w-4 h-4 mr-2 ${c.filter_type==="wishlist"?"fill-blue-700":""}`}),"Sản phẩm yêu thích",w>0&&e.jsx("span",{className:"ml-auto bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:w})]}),n.map(l=>e.jsx("button",{onClick:()=>p("category",l.slug),className:`block w-full text-left px-4 py-3 rounded-lg transition-colors ${c.category===l.slug&&c.filter_type!=="wishlist"?"bg-blue-50 text-blue-700 font-medium border-l-4 border-blue-500":"hover:bg-gray-50"}`,children:l.name},l.id))]})]})]})]})})},pe=()=>{const[n,c]=d.useState([]),[p,S]=d.useState([]),[u,b]=d.useState([]),[w,x]=d.useState(!0),[a,m]=d.useState({category:"",sort:"newest",page:1,filter_type:""}),[_,k]=d.useState(!1),j=s=>{const t=new URLSearchParams(window.location.search);Object.entries(s).forEach(([r,i])=>{i?t.set(r,i):t.delete(r)}),window.history.pushState({},"",`${window.location.pathname}${t.toString()?`?${t.toString()}`:""}`)},g=async s=>{var t,r;try{x(!0);const i=new URLSearchParams;Object.entries(s).forEach(([h,f])=>{f&&h!=="filter_type"&&i.append(h,f)});const[v,y]=await Promise.all([axios.get("/api/v1/categories/featured"),axios.get("/wishlist")]);let o;if(s.filter_type==="wishlist"){const h=((t=y.data)==null?void 0:t.data)||y.data||[],f=Array.isArray(h)?h.map(C=>typeof C=="object"?C.product_id:C):[];f.length>0?(i.append("ids",f.join(",")),o=await axios.get(`/api/v1/products?${i.toString()}`)):o={data:{data:[],current_page:1,last_page:1}}}else o=await axios.get(`/api/v1/products?${i.toString()}`);c(o.data),S(v.data||[]);const N=((r=y.data)==null?void 0:r.data)||y.data||[],A=Array.isArray(N)?N.map(h=>typeof h=="object"?h.product_id:h):[];b(A)}catch(i){console.error("Error fetching data:",i)}finally{x(!1)}};d.useEffect(()=>{const s=new URLSearchParams(window.location.search),t={category:s.get("category")||"",sort:s.get("sort")||"newest",page:parseInt(s.get("page"))||1,filter_type:s.get("filter_type")||""};m(t),g(t);const r=()=>{k(window.scrollY>300)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const l=(s,t)=>{let r={...a,[s]:t,page:1};s==="category"&&(r.filter_type="",r.sort="newest"),s==="filter_type"&&t==="wishlist"&&(r.category=""),m(r),j(r),g(r)},L=async s=>{var t;try{(await axios.post(`/wishlist/toggle/${s}`)).data.added?b(o=>[...o,s]):(b(o=>o.filter(N=>N!==s)),a.filter_type==="wishlist"&&g(a));const i=await axios.get("/wishlist"),v=((t=i.data)==null?void 0:t.data)||i.data||[],y=Array.isArray(v)?v.map(o=>typeof o=="object"?o.product_id:o):[];b(y)}catch(r){console.error("Error toggling wishlist:",r)}},P=()=>{window.scrollTo({top:0,behavior:"smooth"})},$=s=>{const t={...a,page:s};m(t),j(t),g(t),P()};return w?e.jsx(T,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-neutral-300 border-t-neutral-900 animate-spin"})})}):e.jsxs(T,{children:[e.jsx(W,{title:"Products"}),e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("section",{className:"py-20",children:[e.jsxs("div",{className:"mb-12 text-center",children:[e.jsx("span",{className:"text-sm uppercase tracking-wider text-neutral-500",children:"Bộ sưu tập"}),e.jsx("h2",{className:"text-3xl font-light mt-2",children:a.filter_type==="wishlist"?"Sản phẩm yêu thích của bạn":"Sản phẩm của chúng tôi"}),e.jsx("p",{className:"mt-2 text-neutral-500",children:a.filter_type==="wishlist"?"Danh sách những sản phẩm bạn đã thêm vào yêu thích":"Tìm kiếm sản phẩm phù hợp với nhu cầu của bạn"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12",children:[e.jsx(z,{categories:p,filters:a,onFilterChange:l,wishlistCount:u.length}),e.jsx("div",{className:"flex-1",children:n&&n.data&&n.data.length===0?e.jsxs("div",{className:"text-center py-12 bg-white border border-neutral-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a.filter_type==="wishlist"?"Bạn chưa có sản phẩm yêu thích nào":"Chúng tôi không tìm thấy sản phẩm nào"}),e.jsx("p",{className:"mt-2 text-neutral-500",children:a.filter_type==="wishlist"?"Hãy thêm sản phẩm vào danh sách yêu thích để xem tại đây":"Hãy thử tìm kiếm lại hoặc xem các sản phẩm khác"})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{products:n.data||[],onToggleWishlist:L,wishlist:u}),n&&n.last_page&&n.last_page>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("div",{className:"flex space-x-2",children:[...Array(n.last_page)].map((s,t)=>e.jsx("button",{onClick:()=>$(t+1),className:`px-4 py-2 rounded-lg ${n.current_page===t+1?"bg-blue-600 text-white":"bg-white border border-neutral-200 hover:bg-neutral-50"}`,children:t+1},t))})})]})})]})]})}),_&&e.jsx("button",{onClick:P,className:"fixed bottom-8 right-8 p-3 bg-white/80 backdrop-blur-sm border border-neutral-200 rounded-full shadow-lg transition-all duration-300 hover:bg-white",children:e.jsx(B,{className:"w-5 h-5"})})]})]})};export{pe as default};
