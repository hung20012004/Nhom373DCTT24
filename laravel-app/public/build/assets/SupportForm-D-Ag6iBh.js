import{r as d,m as D,j as e,a as N}from"./app-DM5lWH7w.js";import{u as T}from"./use-toast-CcV5NpMB.js";import{D as C,a as E,b as F,c as V,f as k,d as q}from"./dialog-_yQDYPAD.js";import{T as A}from"./textarea-V4QGxS2H.js";import{B as b}from"./button-D_azY7HU.js";import{L as _}from"./label-Dh85IkX1.js";import{S as R,a as w,b as L,c as M,d as o}from"./select-lTbdTkTd.js";import{A as G,a as O}from"./alert-cZJMHzEk.js";import"./index-v8iwHGUi.js";import"./utils-De8wPBUk.js";import"./index-ijvaBZ7a.js";import"./index-B4EdUvDt.js";import"./x-ToVJaZZw.js";import"./index-H22tECQ6.js";import"./index-BeqeRdpr.js";import"./index-o3Sz-yc3.js";import"./check-Ct5f1nwX.js";const re=({orderId:u,onClose:n,onSuccess:h})=>{const[c,l]=d.useState(!1),[m,x]=d.useState(""),[r,g]=d.useState({}),{toast:p}=T(),t=D({issue_type:"",description:"",contact_preference:"email"}),S=async()=>{var i,j,v,y,f;l(!0),x(""),g({});try{const s=(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"),a=await N.post(`/support-requests/${u}`,{issue_type:t.data.issue_type,description:t.data.description,contact_preference:t.data.contact_preference},{headers:{"X-CSRF-TOKEN":s,Accept:"application/json","Content-Type":"application/json"}});l(!1),t.reset(),p({title:"Thành công",description:"Yêu cầu đã được gửi. Nhân viên hỗ trợ sẽ liên hệ với bạn trong thời gian sớm nhất."}),h&&h(),n&&n()}catch(s){if(l(!1),s.response&&s.response.status===422){g(s.response.data.errors||{});const a=Object.values(s.response.data.errors||{}).flat().join(", ");p({title:"Lỗi",description:a||"Vui lòng kiểm tra các trường dữ liệu",variant:"destructive"})}else{const a=((v=(j=s.response)==null?void 0:j.data)==null?void 0:v.error)||((f=(y=s.response)==null?void 0:y.data)==null?void 0:f.message)||"Đã xảy ra lỗi khi gửi yêu cầu hỗ trợ";x(a),p({title:"Lỗi",description:a,variant:"destructive"})}}};return e.jsx(C,{open:!0,onOpenChange:n,children:e.jsxs(E,{className:"sm:max-w-md",children:[e.jsxs(F,{children:[e.jsx(V,{children:"Yêu cầu hỗ trợ"}),e.jsxs(k,{children:["Gửi yêu cầu hỗ trợ cho đơn hàng #",u,". Nhân viên hỗ trợ sẽ liên hệ với bạn trong thời gian sớm nhất."]})]}),m&&e.jsx(G,{variant:"destructive",children:e.jsx(O,{children:m})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"issue_type",children:"Vấn đề"}),e.jsxs(R,{value:t.data.issue_type,onValueChange:i=>t.setData("issue_type",i),children:[e.jsx(w,{id:"issue_type",className:r.issue_type?"border-red-500":"",children:e.jsx(L,{placeholder:"Chọn loại vấn đề"})}),e.jsxs(M,{children:[e.jsx(o,{value:"shipping",children:"Vấn đề vận chuyển"}),e.jsx(o,{value:"product",children:"Vấn đề sản phẩm"}),e.jsx(o,{value:"payment",children:"Vấn đề thanh toán"}),e.jsx(o,{value:"other",children:"Khác"})]})]}),r.issue_type&&e.jsx("p",{className:"text-sm text-red-500",children:r.issue_type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"description",children:"Mô tả chi tiết"}),e.jsx(A,{id:"description",placeholder:"Mô tả chi tiết vấn đề của bạn...",value:t.data.description,onChange:i=>t.setData("description",i.target.value),className:`w-full ${r.description?"border-red-500":""}`,rows:4}),r.description&&e.jsx("p",{className:"text-sm text-red-500",children:r.description})]})]}),e.jsxs(q,{children:[e.jsx(b,{variant:"outline",onClick:n,disabled:c,children:"Hủy"}),e.jsx(b,{variant:"default",onClick:S,disabled:c||!t.data.issue_type||!t.data.description,children:c?"Đang gửi...":"Gửi yêu cầu"})]})]})})};export{re as default};
